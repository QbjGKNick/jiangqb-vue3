{
  "version": 3,
  "sources": ["../src/index.ts", "../src/effect.ts", "../../shared/src/index.ts", "../src/reactive.ts"],
  "sourcesContent": ["export { effect } from \"./effect\";\nexport { reactive } from \"./reactive\";\n", "export class ReactiveEffect {\n  constructor(public fn: any) {} // \u4F60\u4F20\u9012\u7684fn\u6211\u4F1A\u9ED8\u8BA4\u5E2E\u4F60\u653E\u5230this\u4E0A\uFF0C\u7B49\u4EF7\u4E8E\u5982\u4E0B\u5199\u6CD5\n  // public fn: any\n  // constructor(fn: any) {\n  //    this.fn = fn\n  // }\n  run() {\n    this.fn();\n  }\n}\n\nexport function effect(fn: any) {\n  // \u5C06\u7528\u6237\u4F20\u9012\u51FD\u6570\u53D8\u6210\u54CD\u5E94\u5F0F\u7684 effect\n\n  const _effect = new ReactiveEffect(fn);\n  _effect.run();\n}\n", "export const isObject = (value: any) => {\n  return typeof value === \"object\" && value !== null\n}\n", "import { isObject } from \"@jiangqb-vue3/shared\";\n\nconst reactiveMap = new WeakMap(); // key\u5FC5\u987B\u662F\u5BF9\u8C61\uFF0C\u5F31\u5F15\u7528\n// v8\u7684\u5783\u573E\u56DE\u6536\u673A\u5236  \u6807\u8BB0\u5220\u9664  \u5F15\u7528\u8BA1\u6570\n\nconst enum ReactiveFlags {\n  IS_REACTIVE = \"__v_isReactive\",\n}\nexport function reactive(target: any) {\n  if (!isObject(target)) return target;\n\n  if (target[ReactiveFlags.IS_REACTIVE]) {\n    return target;\n  }\n\n  const existing = reactiveMap.get(target);\n  if (existing) return existing;\n  // es6 \u4E2D\u7684proxy\n  const proxy = new Proxy(target, {\n    get(target, key, receiver) {\n      if (key === ReactiveFlags.IS_REACTIVE) {\n        return true;\n      }\n      console.log(\"\u8FD9\u91CC\u53EF\u4EE5\u8BB0\u5F55\u8FD9\u4E2A\u5C5E\u6027\u4F7F\u7528\u4E86\u54EA\u4E2Aeffect\");\n      return Reflect.get(target, key, receiver);\n      // return target[key];\n    },\n    set(target, key, receiver, value) {\n      console.log(\"\u8FD9\u91CC\u53EF\u4EE5\u901A\u77E5effect\u91CD\u65B0\u6267\u884C\");\n      // target[key] = value;\n      return Reflect.set(target, key, value, receiver);\n    },\n  });\n  reactiveMap.set(target, proxy);\n  return proxy;\n}\n// \u4E00\u4E2A\u5BF9\u8C61\u5DF2\u7ECF\u88AB\u4EE3\u7406\u8FC7\u4E86\uFF0C\u5C31\u4E0D\u8981\u518D\u6B21\u88AB\u4EE3\u7406\u4E86\n\n// \u4F7F\u7528 proxy \u8981\u642D\u914D Reflect \u6765\u4F7F\u7528 obj -> proxy\n// \u4E0B\u6B21\u4F60\u4F20\u5165\u7684\u662Fproxy\uFF0C\u6211\u53BB\u8FD9\u4E2A\u5BF9\u8C61\u4E0A\u53D6\u503C\u53EF\u4EE5\u547D\u4E2Dproxy\u7684get\u65B9\u6CD5\n\nlet person = {\n  name: \"nick\",\n  get aliasName() {\n    // \u5C5E\u6027\u8BBF\u95EE\u5668\n    return this.name + \"jg\";\n  },\n};\n\n/*\nconst proxy = new Proxy(person, {\n  get(target, key, receiver) {\n    console.log(\"\u8FD9\u91CC\u53EF\u4EE5\u8BB0\u5F55\u8FD9\u4E2A\u5C5E\u6027\u4F7F\u7528\u4E86\u54EA\u4E2Aeffect\");\n    console.log(key);\n    // return target[key];\n    return Reflect.get(target, key, receiver); // \u5C06person\u4E2Dget\u91CC\u7684this\u6307\u5411receiver\u800C\u975Eperson\n  },\n  set(target, key, receiver, value) {\n    console.log(\"\u8FD9\u91CC\u53EF\u4EE5\u901A\u77E5effect\u91CD\u65B0\u6267\u884C\");\n    // target[key] = value;\n    return Reflect.set(target, key, value, receiver);\n  },\n});\n\n// \u539F\u56E0\u662F\u56E0\u4E3A\u6211\u53BB proxy\u4E0A\u53BB\u53D6aliasName\uFF0C\u8FD9\u4E2A\u65F6\u5019\u4F1A\u6267\u884Cget\u65B9\u6CD5\uFF0C\u4F46\u662FaliasName \u662F\u57FA\u4E8Ename\u5C5E\u6027 \u539F\u5219\u4E0A\u5E94\u8BE5\u53BBname \u4E0A\u53D6\u503C\n// \u7136\u800Cthis.name \u5E76\u6CA1\u6709\u89E6\u53D1proxy\u7684get\uFF0C\u4E5F\u5C31\u610F\u5473\u7740\u7A0D\u540E\u6211\u4EEC\u4FEE\u6539name\u5C5E\u6027\u7684\u65F6\u5019\uFF0C\u5C31\u4E0D\u4F1A\u5BFC\u81F4\u9875\u9762\u91CD\u65B0\u6E32\u67D3\nproxy.aliasName;\n\n*/\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAO,MAAM,iBAAN,MAAqB;AAAA,IAC1B,YAAmB,IAAS;AAAT;AAAA,IAAU;AAAA,IAK7B,MAAM;AACJ,WAAK,GAAG;AAAA,IACV;AAAA,EACF;AAEO,WAAS,OAAO,IAAS;AAG9B,UAAM,UAAU,IAAI,eAAe,EAAE;AACrC,YAAQ,IAAI;AAAA,EACd;;;AChBO,MAAM,WAAW,CAAC,UAAe;AACtC,WAAO,OAAO,UAAU,YAAY,UAAU;AAAA,EAChD;;;ACAA,MAAM,cAAc,oBAAI,QAAQ;AAMzB,WAAS,SAAS,QAAa;AACpC,QAAI,CAAC,SAAS,MAAM;AAAG,aAAO;AAE9B,QAAI,OAAO,qCAA4B;AACrC,aAAO;AAAA,IACT;AAEA,UAAM,WAAW,YAAY,IAAI,MAAM;AACvC,QAAI;AAAU,aAAO;AAErB,UAAM,QAAQ,IAAI,MAAM,QAAQ;AAAA,MAC9B,IAAIA,SAAQ,KAAK,UAAU;AACzB,YAAI,QAAQ,oCAA2B;AACrC,iBAAO;AAAA,QACT;AACA,gBAAQ,IAAI,kGAAuB;AACnC,eAAO,QAAQ,IAAIA,SAAQ,KAAK,QAAQ;AAAA,MAE1C;AAAA,MACA,IAAIA,SAAQ,KAAK,UAAU,OAAO;AAChC,gBAAQ,IAAI,oEAAkB;AAE9B,eAAO,QAAQ,IAAIA,SAAQ,KAAK,OAAO,QAAQ;AAAA,MACjD;AAAA,IACF,CAAC;AACD,gBAAY,IAAI,QAAQ,KAAK;AAC7B,WAAO;AAAA,EACT;",
  "names": ["target"]
}
